# TODOLIST — APALLAKTIS Mobile-First SaaS

## Легенда
- **Оценка**: максимум 4 человекочаса на задачу
- **Критерии успешности**: конкретные проверяемые условия
- **Файлы в контексте**: что должно быть открыто у нейросети

---

## ФАЗА 1: ИНФРАСТРУКТУРА И НАСТРОЙКА

### Задача 1.1: Инициализация проекта и структура
**Оценка**: 2 ч

**Описание**:
- Создать Next.js проект с TypeScript
- Настроить mobile-first подход (viewport 360-414px)
- Создать базовую структуру папок
- Настроить safe-area-inset для iOS

**Критерии успешности**:
- [ ] `npm run dev` запускается без ошибок
- [ ] Viewport настроен на mobile (meta viewport)
- [ ] CSS variables для safe-area созданы
- [ ] Структура папок соответствует спецификации
- [ ] ESLint и TypeScript настроены

**Файлы в контексте**:
- `TODO.txt` (техническое задание)
- `APALLAKTIS .txt`
- `package.json`
- `next.config.js`
- `tsconfig.json`

**Результат**:
```
frontend/
  src/
    app/
    components/
    styles/
    lib/
    types/
  public/
    video/
    pages/
```

---

### Задача 1.2: Дизайн-система — палитра и типографика
**Оценка**: 2 ч

**Описание**:
- Создать CSS/SCSS переменные из APALLAKTIS.txt
- Настроить Noto Sans + Noto Sans Arabic
- Создать утилиты для размеров текста (14/16/20-22px)
- Создать миксин для кнопок с правилом "shadow-color == text-color"

**Критерии успешности**:
- [ ] Все 9 цветов из палитры доступны как CSS variables
- [ ] Noto Sans загружается корректно
- [ ] Созданы классы для размеров текста
- [ ] Миксин button() применяет правило теней
- [ ] Не добавлено ни одного цвета кроме указанных в палитре

**Файлы в контексте**:
- `APALLAKTIS .txt`
- `TODO.txt` (раздел дизайн-система)
- `src/styles/variables.scss`
- `src/styles/typography.scss`
- `src/styles/mixins.scss`

**Результат**:
```scss
// variables.scss
--orange: #ff6a1a;
--deep-teal: #01312d;
// ... остальные

// mixins.scss
@mixin button($bg-color, $text-color) {
  background: $bg-color;
  color: $text-color;
  box-shadow: 0 4px 8px $text-color;
}
```

---

### Задача 1.3: i18n настройка — 8 языков
**Оценка**: 3 ч

**Описание**:
- Установить next-i18next или react-i18next
- Создать файлы переводов для 8 языков
- Настроить RTL только для арабского
- Создать middleware для определения языка

**Критерии успешности**:
- [ ] 8 языков настроены (el, ru, uk, sq, bg, ro, en, ar)
- [ ] RTL работает только для ar
- [ ] Переводы загружаются динамически
- [ ] Смена языка работает без перезагрузки
- [ ] Текущий язык сохраняется в localStorage

**Файлы в контексте**:
- `TODO.txt` (раздел языки и локализация)
- `public/locales/el/common.json`
- `public/locales/ru/common.json`
- ... (все 8 языков)
- `src/lib/i18n.ts`

**Структура переводов**:
```json
{
  "landing": {
    "slogan": "Τέλος στη ρουτίνα",
    "login": "Είσοδος",
    "register": "Δημιουργία λογαριασμού"
  }
}
```

---

## ФАЗА 2: ПУБЛИЧНЫЕ СТРАНИЦЫ (ONBOARDING)

### Задача 2: Первая страница — Страница выбора языка (video.mp4) ✅ ГОТОВО
**Оценка**: 2 ч

**Описание**:
- Fullscreen видео фон `/public/video/video.mp4` (fixed position)
- Слоган "Τέλος στη ρουτίνα!" (#ff8f0a, ВСЕГДА с восклицательным знаком!, ширина 75% от логотипа)
- Grid 2 колонки × 4 строки с языками
- Порядок фиксирован (Ελληνικά, Русский, Українська, Shqip, Български, Română, English, العربية)
- Без флагов, только native names
- Кнопки языков: цвет #daf3f6 (var(--polar)), text+shadow=#01312d (var(--deep-teal)), высота 52px

**Критерии успешности**:
- [x] Видео video.mp4 воспроизводится в фоне (loop, muted, autoplay)
- [x] Слоган видим на всех разрешениях 360-414px
- [x] Все 8 языков в правильном порядке
- [x] Нет флагов
- [x] Клик меняет язык и переходит на следующую страницу
- [x] Правило теней соблюдено (shadow=#01312d)
- [x] Gap между кнопками 12px (gap-3)
- [x] Язык сохраняется в localStorage
- [x] RTL работает для العربية
- [x] Слоган с восклицательным знаком
- [x] Цвет слогана #ff8f0a
- [x] Высота кнопок 52px

**Файлы в контексте**:
- `TODO.txt` (раздел 2)
- `APALLAKTIS .txt`
- `public/video/video.mp4`
- `src/app/language-select/page.tsx`
- `src/components/LanguageSelector.tsx`
- `src/components/VideoBackground.tsx`
- `src/lib/i18n.ts`

**Компоненты**:
- `VideoBackground` — fullscreen video с poster
- `LanguageSelector` — слоган + 8 кнопок языков

---

### Задача 3: Вторая страница — Вход (video1.mp4) ✅ ГОТОВО
**Оценка**: 3 ч

**Описание**:
- Fullscreen видео фон `/public/video/video1.mp4` (fixed position)
- Слоган "Τέλος στη ρουτίνα!" (#ff8f0a, ВСЕГДА с восклицательным знаком!, ширина 75% от логотипа)
- Кнопки "Είσοδος" и "Δημιουργία λογαριασμού" (переведены на все 8 языков)
- Кнопки: цвет #daf3f6 (var(--polar)), text+shadow=#01312d (var(--deep-teal)), высота 52px
- UI появляется сразу, видео грузится async
- Poster image для видео

**ВАЖНО:**
- Юридические кнопки (Πολιτική | Όροι) НЕ на этой странице
- Они будут на странице регистрации (Задача 2.4) вместе с чекбоксом согласия

**Критерии успешности**:
- [x] Видео video1.mp4 воспроизводится в фоне (loop, muted, autoplay)
- [x] Слоган видим на всех разрешениях 360-414px
- [x] UI рендерится мгновенно (не ждёт видео)
- [x] Используется env(safe-area-inset-top/bottom)
- [x] При медленном интернете показывается poster
- [x] Кнопки bg=#daf3f6, text+shadow=#01312d
- [x] Переводы работают на всех 8 языках
- [x] Слоган с восклицательным знаком
- [x] Цвет слогана #ff8f0a
- [x] Высота кнопок 52px
- [x] Кнопки центрированы вертикально

**Файлы в контексте**:
- `TODO.txt` (раздел 3)
- `APALLAKTIS .txt`
- `public/video/video1.mp4`
- `src/app/[locale]/page.tsx`
- `src/components/VideoBackground.tsx`

**Компоненты**:
- `VideoBackground` — fullscreen video с poster
- `LandingPage` — слоган + кнопки + юридические ссылки

---

### Задача 2.3: Страница после выбора языка — video.mp4
**Оценка**: 2 ч

**Описание**:
- Видео фон: /public/video/video.mp4
- Одна кнопка входа: bg=#e2f1dd, text+shadow=#01312d
- Переход на /login или /register

**Критерии успешности**:
- [ ] Видео воспроизводится корректно
- [ ] Кнопка центрирована
- [ ] Текст кнопки переведен на выбранный язык
- [ ] Правило теней соблюдено
- [ ] Переход работает

**Файлы в контексте**:
- `TODO.txt` (раздел 7.2)
- `public/video/video.mp4`
- `src/app/[lang]/welcome/page.tsx`

---

### Задача 2.4: Регистрация — форма (без/с invoice)
**Оценка**: 4 ч

**Описание**:
- Toggle: "Без invoice" / "С invoice"
- Без invoice: имя, email, телефон + код страны
- С invoice: название компании, ΑΦΜ, ΔΟΥ (термины на греческом всегда)
- Валидация полей

**Юридика (внизу страницы):**
- Чекбокс согласия (unchecked по умолчанию): "Прочитал и согласен с условиями"
- Две юридические кнопки (2 колонки, как кнопки языков):
  - "Πολιτική Απορρήτου" / "Privacy Policy" / "Политика конфиденциальности" (переведено на текущий язык)
  - "Όροι Χρήσης" / "Terms of Use" / "Условия использования" (переведено на текущий язык)
  - цвет: #daf3f6 (var(--polar))
  - шрифт + тень: #01312d (var(--deep-teal))
  - высота: 52px (как кнопки входа)
  - отступ снизу: 80px
  - открывают страницы /[locale]/terms и /[locale]/privacy

**Критерии успешности**:
- [ ] Нельзя submit без чекбокса
- [ ] Email валидируется
- [ ] Телефон валидируется с кодом страны
- [ ] ΑΦΜ и ΔΟΥ показываются только при выборе invoice
- [ ] Термины ΑΦΜ, ΔΟΥ всегда на греческом
- [ ] Ошибки показываются на текущем языке
- [ ] Юридические кнопки переведены на текущий язык
- [ ] Юридические кнопки открывают соответствующие страницы
- [ ] Юридические кнопки имеют высоту 52px и правильные цвета

**Файлы в контексте**:
- `TODO.txt` (раздел 10 юридика, раздел регистрация)
- `src/app/[lang]/register/page.tsx`
- `src/components/RegisterForm.tsx`
- `src/lib/validation.ts`

---

### Задача 2.5: Юридические страницы — /terms и /privacy
**Оценка**: 2 ч

**Описание**:
- Две страницы с многоязычным контентом
- RTL для арабского
- Простой layout с текстом
- Ссылки работают с текущего языка

**Критерии успешности**:
- [ ] /[lang]/terms работает
- [ ] /[lang]/privacy работает
- [ ] RTL корректен для ar
- [ ] Контент переведен на все 8 языков
- [ ] Навигация назад работает

**Файлы в контексте**:
- `TODO.txt` (раздел 10 юридика)
- `src/app/[lang]/terms/page.tsx`
- `src/app/[lang]/privacy/page.tsx`
- `public/locales/*/legal.json`

---

## ФАЗА 3: АУТЕНТИФИКАЦИЯ И DEMO

### Задача 3.1: Авторизация — login/logout
**Оценка**: 3 ч

**Описание**:
- Форма входа (email + пароль)
- JWT или session-based auth
- Protected routes
- Logout функция

**Критерии успешности**:
- [ ] Успешный login перенаправляет на /dashboard
- [ ] Неверные credentials показывают ошибку
- [ ] Token сохраняется (cookie или localStorage)
- [ ] Protected routes редиректят на /login
- [ ] Logout очищает сессию

**Файлы в контексте**:
- `src/app/[lang]/login/page.tsx`
- `src/lib/auth.ts`
- `src/middleware.ts`
- `src/types/user.ts`

---

### Задача 3.2: DEMO режим — 48 часов, 3 объекта
**Оценка**: 3 ч

**Описание**:
- После регистрации автоматически активировать DEMO
- Таймер 48 часов от момента регистрации
- Ограничение: максимум 3 объекта
- После истечения — редирект на страницу подписки

**Критерии успешности**:
- [ ] DEMO активируется при создании аккаунта
- [ ] Таймер отображается в UI
- [ ] Нельзя создать больше 3 объектов в DEMO
- [ ] После 48ч доступ переходит в read-only или блокируется
- [ ] Показывается предупреждение за 6 часов до окончания

**Файлы в контексте**:
- `TODO.txt` (раздел 11 подписки)
- `src/lib/subscription.ts`
- `src/types/user.ts`
- `src/components/DemoTimer.tsx`
- `src/middleware.ts`

**Данные пользователя**:
```ts
interface User {
  id: string;
  demoExpiresAt: Date | null;
  subscriptionStatus: 'demo' | 'active' | 'expired' | 'vip';
}
```

---

## ФАЗА 4: ВНУТРЕННИЕ СТРАНИЦЫ (CORE FUNCTIONALITY)

### Задача 4.1: Фоновые страницы — циклический fallback
**Оценка**: 2 ч

**Описание**:
- Использовать page-01.webp ... page-08.webp
- После page-08 начинать с page-01 (цикл)
- Компонент BackgroundPage принимает pageIndex
- Кнопки на этих страницах: bg=#daf3f6, text+shadow=#01312d

**Критерии успешности**:
- [ ] Функция getBackgroundPage(index) возвращает правильный файл
- [ ] Цикл работает (9 → page-01, 10 → page-02)
- [ ] Изображения оптимизированы (webp)
- [ ] Layout адаптируется под разные страницы

**Файлы в контексте**:
- `TODO.txt` (раздел 5.3 медиа, раздел 18)
- `src/lib/backgrounds.ts`
- `src/components/BackgroundPage.tsx`
- `public/pages/page-*.webp`

**Код**:
```ts
export function getBackgroundPage(index: number): string {
  const pageNum = ((index - 1) % 8) + 1;
  return `/pages/page-${String(pageNum).padStart(2, '0')}.webp`;
}
```

---

### Задача 4.2: page-pay — настройка оплат и расходов
**Оценка**: 3 ч

**Описание**:
- Две кнопки:
  - "Способы оплаты" (ΤΡΟΠΟΙ ΠΛΗΡΩΜΗΣ): bg=#ffd8c3
  - "Общие расходы" (ΓΕΝΙΚΑ ΕΞΟΔΑ): bg=#ffebe1
- Обе: text+shadow=#01312d
- Переходы на соответствующие страницы

**Критерии успешности**:
- [ ] Фон: page-pay.webp
- [ ] Кнопки корректных цветов
- [ ] Правило теней соблюдено
- [ ] Переходы работают
- [ ] Тексты переведены на все языки

**Файлы в контексте**:
- `TODO.txt` (раздел 7.3)
- `src/app/[lang]/dashboard/page-pay/page.tsx`
- `public/pages/page-pay.webp`

---

### Задача 4.3: Способы оплаты — CRUD
**Оценка**: 4 ч

**Описание**:
- Типы: наличные, кредитная карта, дебетовая карта, банковский счет
- Для карт: последние 4 цифры, название
- Для счетов: IBAN или название
- CRUD: создать, редактировать, удалить
- Цвет всех экранов: bg=#ffd8c3

**Критерии успешности**:
- [ ] Можно добавить способ оплаты
- [ ] Можно редактировать
- [ ] Можно удалить (с подтверждением)
- [ ] Список сохраняется в БД
- [ ] Цвет bg=#ffd8c3 на всех экранах этого раздела

**Файлы в контексте**:
- `TODO.txt` (раздел 8.1)
- `src/app/[lang]/dashboard/payment-methods/page.tsx`
- `src/components/PaymentMethodForm.tsx`
- `src/types/paymentMethod.ts`
- `src/lib/api/paymentMethods.ts`

**Типы**:
```ts
type PaymentMethodType = 'cash' | 'credit_card' | 'debit_card' | 'bank_account';

interface PaymentMethod {
  id: string;
  type: PaymentMethodType;
  name: string;
  lastFourDigits?: string; // для карт
  iban?: string; // для счетов
}
```

---

### Задача 4.4: Общие расходы — CRUD
**Оценка**: 4 ч

**Описание**:
- Глобальные расходы (не привязаны к объекту)
- Поля: название, дата, категория, сумма
- Категории редактируемые
- Цвет всех экранов: bg=#ffebe1

**Критерии успешности**:
- [ ] Можно добавить общий расход
- [ ] Можно редактировать
- [ ] Можно удалить
- [ ] Категории можно создавать/редактировать
- [ ] Цвет bg=#ffebe1 на всех экранах

**Файлы в контексте**:
- `TODO.txt` (раздел 8.2)
- `src/app/[lang]/dashboard/global-expenses/page.tsx`
- `src/components/GlobalExpenseForm.tsx`
- `src/types/expense.ts`

---

### Задача 4.5: Каталог расходов — категории
**Оценка**: 2 ч

**Описание**:
- Глобальный список категорий
- Сортировка алфавитная по текущему языку
- CRUD для категорий

**Критерии успешности**:
- [ ] Категории сортируются правильно для всех языков
- [ ] Можно добавить/редактировать/удалить
- [ ] Категории переводятся или хранятся по языкам
- [ ] Используются в расходах объектов

**Файлы в контексте**:
- `TODO.txt` (раздел 8.3)
- `src/app/[lang]/dashboard/expense-categories/page.tsx`
- `src/types/category.ts`

---

## ФАЗА 5: ОБЪЕКТЫ

### Задача 5.1: Список объектов — карусель "колода карт"
**Оценка**: 4 ч

**Описание**:
- Deck carousel: центральная карта большая, боковые меньше
- Свайп для навигации
- Фильтр: Ανοιχτά / Κλειστά (открытые/закрытые)
- Цвета объектов: градация #e7f4f1 → #c3e2dc (детерминированно по индексу)
- Фон: page-objekt.webp

**Критерии успешности**:
- [ ] Карусель работает (свайп, клик)
- [ ] Центральная карта visually prominent
- [ ] Фильтр переключается
- [ ] Цвет объекта вычисляется по формуле (не random)
- [ ] Smooth transitions

**Файлы в контексте**:
- `TODO.txt` (раздел 7.4)
- `src/app/[lang]/dashboard/objects/page.tsx`
- `src/components/ObjectCarousel.tsx`
- `src/lib/objectColors.ts`
- `public/pages/page-objekt.webp`

**Формула цвета**:
```ts
function getObjectColor(index: number, total: number): string {
  const start = { r: 231, g: 244, b: 241 }; // #e7f4f1
  const end = { r: 195, g: 226, b: 220 };   // #c3e2dc
  const ratio = total > 1 ? index / (total - 1) : 0;
  const r = Math.round(start.r + (end.r - start.r) * ratio);
  const g = Math.round(start.g + (end.g - start.g) * ratio);
  const b = Math.round(start.b + (end.b - start.b) * ratio);
  return `rgb(${r}, ${g}, ${b})`;
}
```

---

### Задача 5.2: Создание/редактирование объекта
**Оценка**: 3 ч

**Описание**:
- Название объекта
- Адрес
- Клиент (имя, контакт)
- Статус: открыт/закрыт
- Договорная цена

**Критерии успешности**:
- [ ] Форма валидируется
- [ ] Объект сохраняется в БД
- [ ] Можно редактировать существующий
- [ ] При создании цвет назначается автоматически

**Файлы в контексте**:
- `src/app/[lang]/dashboard/objects/new/page.tsx`
- `src/app/[lang]/dashboard/objects/[id]/edit/page.tsx`
- `src/components/ObjectForm.tsx`
- `src/types/object.ts`

---

### Задача 5.3: Финансы объекта — расчёты с клиентом
**Оценка**: 4 ч

**Описание**:
- Договорная цена (без знака)
- Доп. цены (+)
- Оплаты от клиента (−) — цвет #ff6a1a
- Баланс: Contract + Extras − Paid
- Привязка к способам оплаты

**Критерии успешности**:
- [ ] Баланс вычисляется корректно
- [ ] Минус красный (#ff6a1a)
- [ ] Можно добавить доп. цену
- [ ] Можно добавить оплату с выбором метода
- [ ] Статус баланса: долг/закрыто/переплата

**Файлы в контексте**:
- `TODO.txt` (раздел 8.4.1)
- `src/app/[lang]/dashboard/objects/[id]/finance/page.tsx`
- `src/components/FinanceList.tsx`
- `src/types/finance.ts`

**Модель**:
```ts
interface ObjectFinance {
  objectId: string;
  contractPrice: number;
  extras: { date: Date; amount: number; description: string }[];
  payments: { date: Date; amount: number; methodId: string }[];
  balance: number; // computed
}
```

---

### Задача 5.4: Расходы объекта — категории, фото, дата
**Оценка**: 4 ч

**Описание**:
- Категория (из каталога + создание новой)
- Дата (calendar picker)
- Сумма
- Фото чека (upload)
- Объект обязателен

**Критерии успешности**:
- [ ] Можно выбрать категорию
- [ ] Можно создать новую категорию на лету
- [ ] Календарь работает
- [ ] Фото загружается и сохраняется
- [ ] Список расходов фильтруется по объекту

**Файлы в контексте**:
- `TODO.txt` (раздел 8.4.2)
- `src/app/[lang]/dashboard/objects/[id]/expenses/page.tsx`
- `src/components/ExpenseForm.tsx`
- `src/components/DatePicker.tsx`
- `src/lib/upload.ts`

---

## ФАЗА 6: ПОДПИСКИ И МОНЕТИЗАЦИЯ

### Задача 6.1: Экран подписок — планы и оплата
**Оценка**: 3 ч

**Описание**:
- Варианты: разовая покупка, месячная подписка
- Интеграция с платёжной системой (Stripe/другое)
- Показывать после окончания DEMO или из меню

**Критерии успешности**:
- [ ] Планы отображаются
- [ ] Клик ведёт на форму оплаты
- [ ] После оплаты статус меняется
- [ ] Redirects работают

**Файлы в контексте**:
- `TODO.txt` (раздел 11)
- `src/app/[lang]/subscription/page.tsx`
- `src/lib/stripe.ts` (или другой провайдер)
- `src/types/subscription.ts`

---

### Задача 6.2: Управление подписками — Grace period и Expired
**Оценка**: 2 ч

**Описание**:
- Состояния: Active, Grace (read-only), Expired
- Grace period: 7 дней после окончания (опционально)
- Middleware проверяет статус

**Критерии успешности**:
- [ ] Active даёт полный доступ
- [ ] Grace даёт read-only
- [ ] Expired блокирует доступ
- [ ] VIP перекрывает всё

**Файлы в контексте**:
- `TODO.txt` (раздел 11)
- `src/lib/subscription.ts`
- `src/middleware.ts`
- `src/types/user.ts`

---

### Задача 6.3: VIP активация (Admin) — форма
**Оценка**: 2 ч

**Описание**:
- Форма для админа
- Поля: email, период (1м/3м/6м/1г/дата/бессрочно), причина
- Кнопки: "Активировать VIP", "Отмена"

**Критерии успешности**:
- [ ] Только админ может открыть
- [ ] Email валидируется
- [ ] VIP активируется и перезаписывает подписку
- [ ] Причина сохраняется (опционально)

**Файлы в контексте**:
- `TODO.txt` (раздел 12)
- `src/app/[lang]/admin/vip/page.tsx`
- `src/lib/admin.ts`

---

### Задача 6.4: Реферальная программа — генерация ссылок
**Оценка**: 3 ч

**Описание**:
- У каждого юзера есть referralCode
- Ссылка: /register?ref=CODE
- Бонус: приведи друга → +1 месяц
- Условие начисления (после оплаты друга)

**Критерии успешности**:
- [ ] referralCode генерируется при регистрации
- [ ] Ссылка копируется
- [ ] При регистрации по ссылке ref сохраняется
- [ ] Бонус начисляется после покупки другом подписки
- [ ] История рефералов видна

**Файлы в контексте**:
- `TODO.txt` (раздел 13)
- `src/app/[lang]/dashboard/referral/page.tsx`
- `src/lib/referral.ts`
- `src/types/referral.ts`

**Модель**:
```ts
interface User {
  referralCode: string; // уникальный
  referredBy?: string; // код того, кто привёл
}

interface ReferralBonus {
  userId: string;
  referredUserId: string;
  bonusMonths: number;
  grantedAt: Date;
}
```

---

## ФАЗА 7: ЭКСПОРТ И ФИНАЛИЗАЦИЯ

### Задача 7.1: Экспорт — выбор объектов и периода
**Оценка**: 4 ч

**Описание**:
- Multi-select объектов
- Фильтр: открытые/закрытые
- Период: день/неделя/месяц/диапазон
- Включать ли общие расходы (чекбокс)
- Форматы: PDF, Excel

**Критерии успешности**:
- [ ] UI для выбора параметров
- [ ] Можно выбрать несколько объектов
- [ ] Date range picker работает
- [ ] Кнопки "Скачать PDF" и "Скачать Excel"

**Файлы в контексте**:
- `TODO.txt` (раздел 9)
- `src/app/[lang]/dashboard/export/page.tsx`
- `src/components/ExportForm.tsx`

---

### Задача 7.2: Генерация PDF
**Оценка**: 4 ч

**Описание**:
- Использовать библиотеку (jsPDF / react-pdf)
- Включить: финансы объектов, расходы, баланс
- Многоязычность
- RTL для арабского

**Критерии успешности**:
- [ ] PDF генерируется корректно
- [ ] Данные соответствуют фильтрам
- [ ] RTL работает в PDF
- [ ] Файл скачивается

**Файлы в контексте**:
- `TODO.txt` (раздел 9)
- `src/lib/export/pdf.ts`
- `src/types/export.ts`

---

### Задача 7.3: Генерация Excel (.xlsx)
**Оценка**: 3 ч

**Описание**:
- Использовать библиотеку (xlsx / exceljs)
- Листы: финансы, расходы, сводка
- Формулы для балансов

**Критерии успешности**:
- [ ] Excel генерируется
- [ ] Несколько листов (sheets)
- [ ] Данные корректны
- [ ] Файл скачивается

**Файлы в контексте**:
- `TODO.txt` (раздел 9)
- `src/lib/export/excel.ts`
- `src/types/export.ts`

---

### Задача 7.4: PWA — manifest и service worker
**Оценка**: 2 ч

**Описание**:
- Создать manifest.json
- Настроить иконки
- Service worker для offline (опционально)

**Критерии успешности**:
- [ ] Приложение устанавливается на телефон
- [ ] Иконки корректные
- [ ] Splash screen работает
- [ ] Lighthouse PWA score > 90

**Файлы в контексте**:
- `public/manifest.json`
- `public/icons/`
- `next.config.js`

---

## ФАЗА 8: ТЕСТИРОВАНИЕ И ЗАПУСК

### Задача 8.1: Финальная проверка — чеклист
**Оценка**: 2 ч

**Описание**:
Пройти весь флоу:
- [ ] Landing → язык → welcome → register → DEMO
- [ ] page-pay → способы оплаты / общие расходы
- [ ] Объекты → финансы → расходы
- [ ] Экспорт PDF/Excel
- [ ] VIP активация
- [ ] Реферальная программа

**Критерии успешности**:
- [ ] Нет критических багов
- [ ] Mobile UI корректен на 360px и 414px
- [ ] Нет дополнительных цветов
- [ ] Правило теней соблюдено везде
- [ ] RTL работает для арабского

**Файлы в контексте**:
- `TODO.txt` (все разделы)
- Все ключевые компоненты

---

### Задача 8.2: Оптимизация — Core Web Vitals
**Оценка**: 3 ч

**Описание**:
- Оптимизация изображений (webp)
- Lazy loading для видео
- Code splitting
- Lighthouse audit

**Критерии успешности**:
- [ ] LCP < 2.5s
- [ ] FID < 100ms
- [ ] CLS < 0.1
- [ ] Lighthouse Performance > 90

**Файлы в контексте**:
- `next.config.js`
- `src/components/*`

---

## SUMMARY

**Всего задач**: 38
**Общая оценка**: ~110 человекочасов
**Фазы**: 8

### Приоритет запуска MVP:
1. Фаза 1-2: Инфраструктура + Onboarding (16ч)
2. Фаза 3-4: Auth + Core pages (20ч)
3. Фаза 5: Объекты (15ч)
4. Фаза 6: Монетизация (10ч)
5. Фаза 7-8: Экспорт + PWA (18ч)

**Минимальный MVP** (для первого запуска):
- Фазы 1-5: ~51 часов
- Подключить платежи позже (Фаза 6)

---

## ВАЖНЫЕ ПРАВИЛА ДЛЯ CLAUDE CODE

1. **СЛОГАН** — ВСЕГДА пишется с восклицательным знаком: `Τέλος στη ρουτίνα!`
   - Цвет: `#ff8f0a` (НЕ var(--orange), а именно #ff8f0a)
   - Ширина: 75% от ширины экрана
   - Применяется на ВСЕХ страницах где есть слоган

2. **НЕ добавлять новые цвета** — только из APALLAKTIS.txt

3. **Правило теней**: shadow-color == text-color всегда
   - Пример: если `color: var(--deep-teal)`, то `boxShadow: 0 4px 8px var(--deep-teal)`

4. **Юридические кнопки** — только на странице регистрации (Задача 2.4)
   - НЕ на странице входа (Задача 3)
   - Вместе с чекбоксом согласия
   - Высота 52px, цвета как у кнопок языков
   - Переводятся на текущий язык

5. **Высота кнопок:**
   - Кнопки языков: 52px
   - Кнопки входа/регистрации: 52px
   - Юридические кнопки: 52px

6. **Mobile-only**: max-width 420px на desktop, центрирование, темный фон вокруг

7. **Языки**: фиксированный порядок (el, ru, uk, sq, bg, ro, en, ar), без флагов

8. **RTL**: только для арабского (ar)

9. **Объекты**: цвета детерминированно, не random

10. **Фоновые страницы**: цикл page-01..page-08

11. **ΑΦΜ, ΔΟΥ**: всегда на греческом

---

**Документ создан**: 2025-12-16
**Обновлен**: 2025-12-17
**Версия**: 1.1
